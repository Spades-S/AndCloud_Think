{% extends "./../base.html" %}
{%block title%}Dynamic Analysis{%endblock%}
{% block header %}
    <!-- Font Awesome -->
    <link rel="stylesheet" href="/static/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="/static/css/ionicons.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="/static/dash/css/AdminLTE.min.css">
    <link rel="stylesheet" href="/static/dash/css/skins/_all-skins.min.css">
    <link rel="stylesheet" href="/static/css/style.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
{% endblock %}

{% block content %}
<body class="skin-purple fixed" data-spy="scroll" data-target="#scrollspy">
<div class="wrapper">

    <header class="main-header">
        <!-- Logo -->
        <a href="../" class="logo">
            <!-- mini logo for sidebar mini 50x50 pixels -->
            <span class="logo-mini"><b>And</b>Cloud</span>
            <!-- logo for regular state and mobile devices -->
            <span class="logo-lg"><b>And</b>Cloud</span>
        </a>
        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top" role="navigation">
            <!-- Sidebar toggle button-->
            <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">

                <span class="sr-only">Toggle navigation</span>
            </a>

            <div class="navbar-custom-menu">
                <ul class="nav navbar-nav">

                    <!--Menu Items--

                    <!-- Control Sidebar Toggle Button -->
                    <!--
                    <li>
                      <a href="#" data-toggle="control-sidebar"><i class="fa fa-gears"></i> Tools</a>
                    </li>
                  -->
                </ul>
            </div>
        </nav>
    </header>


    <script type="text/javascript" src="/static/js/shCore.js"></script>
    <script type="text/javascript" src="/static/js/shBrushJava.js"></script>
    <link type="text/css" rel="stylesheet" href="/static/css/shCoreDefault.css"/>
    <style type="text/css" media="print">
        @page { size: landscape; }
    </style>
    <script type="text/javascript">SyntaxHighlighter.all();</script>

    <!-- Left side column. contains the logo and sidebar -->
    <aside class="main-sidebar">
        <!-- sidebar: style can be found in sidebar.less -->
        <div class="sidebar" id="scrollspy">

            <!-- sidebar menu: : style can be found in sidebar.less -->
            <ul class="nav sidebar-menu">
                <li class="header">Dynamic Analysis</li>
                <li class="treeview">
                    <a href="javascript::;"><i class="glyphicon glyphicon-phone"></i> API Monitor</a>
                    <ul class="nav treeview-menu">
                        <li><a href="#fileio"><i class="glyphicon glyphicon-file"></i> File IO</a></li>
                        <li><a href="#networkcalls"><i class="fa fa-plug"></i> Network Calls</a></li>
                        <li><a href="#bindercalls"><i class="fa fa-cubes"></i> Binder Calls</a></li>
                        <li><a href="#crypto"><i class="fa fa-flash"></i> Crypto</a></li>
                        <li><a href="#deviceinfo"><i class="fa fa-info"></i> Device Info</a></li>
                        <li><a href="#base64"><i class="fa fa-puzzle-piece"></i> Base64</a></li>
                        <li><a href="#content"><i class="fa fa-reorder"></i> Content</a></li>
                        <li><a href="#sms"><i class="fa fa-comments"></i> SMS</a></li>
                        <li><a href="#devicedata"><i class="fa fa-phone"></i> Device Data</a></li>
                        <li><a href="#dexclassloader"><i class="fa fa-asterisk"></i> Dex Class Loader</a></li>
                        <li><a href="#reflection"><i class="fa fa-object-ungroup"></i> Reflection</a></li>
                        <li><a href="#systemmanager"><i class="fa fa-cogs"></i> System Manager</a></li>
                        <li><a href="#process"><i class="fa fa-bar-chart-o"></i> Process</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <!-- /.sidebar -->
    </aside>

    <!-- Content Wrapper. Contains page content -->
    <div id="app" class="content-wrapper">
        <!-- Content Header (Page header) -->
        <!-- Main content -->
        <div class="content body">


            <!-- ============================================================= -->

            <section id="fileio">
                <h2 class="page-header"></h2>
                <!-- /.box -->

                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title"><i class="glyphicon glyphicon-file"></i> File IO</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="alert alert-info" role="alert">
                            <a  style="text-decoration: none" v-for='fileinfo in fileio'></br>METHOD: {$ fileinfo.mtd $}</br>ARGUMENTS: {$ fileinfo.args $}</br>RETURN DATA: <span v-if="fileinfo.ret">{$ fileinfo.ret $}</span><span v-else>No return data</span></br></a>
                        </div>
                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>


            <!-- ============================================================= -->



            <section id="networkcalls">
                <h2 class="page-header"></h2>
                <!-- /.box -->

                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title"><i class="fa fa-plug"></i> Network Calls</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="alert alert-success" role="alert">
                            <a  style="text-decoration: none" v-for='networkinfo in networkcall'></br>METHOD: {$ networkinfo.mtd $}</br>ARGUMENTS: {$ networkinfo.args $}</br>RETURN DATA: <span v-if="networkinfo.ret">{$ networkinfo.ret $}</span><span v-else>No return data</span></br></a>
                        </div>
                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>


            <!-- ============================================================= -->



            <section id="bindercalls">
                <h2 class="page-header"></h2>
                <!-- /.box -->

                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title"><i class="fa fa-cubes"></i> Binder Calls</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">

                        <div class="alert alert-warning" role="alert">
                            <a  style="text-decoration: none" v-for='binderinfo in bindercall'></br>METHOD: {$ binderinfo.mtd $}</br>ARGUMENTS: {$ binderinfo.args $}</br>RETURN DATA: <span v-if="binderinfo.ret">{$ binderinfo.ret $}</span><span v-else>No return data</span></br></a>
                        </div>

                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>


            <!-- ============================================================= -->


            <section id="crypto">
                <h2 class="page-header"></h2>
                <!-- /.box -->

                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title"><i class="fa fa-flash"></i> Crypto</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">

                        <div class="alert alert-danger" role="alert">
                            <a  style="text-decoration: none" v-for='cryptoinfo in crypto'></br>METHOD: {$ cryptoinfo.mtd $}</br>ARGUMENTS: {$ cryptoinfo.args $}</br>RETURN DATA: <span v-if="cryptoinfo.ret">{$ cryptoinfo.ret $}</span><span v-else>No return data</span></br></a>
                        </div>

                        </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>


            <!-- ============================================================= -->
            <section id="deviceinfo">
                <h2 class="page-header"></h2>
                <!-- /.box -->

                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title"><i class="fa fa-info"></i> Device Info</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">

                        <div class="alert alert-info" role="alert">
                            <a  style="text-decoration: none" v-for='devinfo in deviceinfo'></br>METHOD: {$ devinfo.mtd $}</br>ARGUMENTS: {$ devinfo.args $}</br>RETURN DATA: <span v-if="devinfo.ret">{$ devinfo.ret $}</span><span v-else>No return data</span></br></a>
                        </div>

                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>


            <!-- ============================================================= -->
            <section id="base64">
                <h2 class="page-header"></h2>
                <!-- /.box -->

                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title"><i class="fa fa-puzzle-piece"></i> Base64</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">


                        <div class="alert alert-success" role="alert">
                            <a  style="text-decoration: none" v-for='baseinfo in base64'></br>METHOD: {$ baseinfo.mtd $}</br>ARGUMENTS: {$ baseinfo.args $}</br>RETURN DATA: <span v-if="baseinfo.ret">{$ baseinfo.ret $}</span><span v-else>No return data</span></br></a>
                        </div>

                        </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>


            <!-- ============================================================= -->

            <section id="content">
                <h2 class="page-header"></h2>
                <!-- /.box -->

                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title"><i class="fa fa-reorder"></i> Content</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">

                        <div class="alert alert-warning" role="alert">
                            <a  style="text-decoration: none" v-for='contentinfo in content'></br>METHOD: {$ contentinfo.mtd $}</br>ARGUMENTS: {$ contentinfo.args $}</br>RETURN DATA: <span v-if="contentinfo.ret">{$ contentinfo.ret $}</span><span v-else>No return data</span></br></a>
                        </div>
                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>


            <!-- ============================================================= -->

            <section id="sms">
                <h2 class="page-header"></h2>
                <!-- /.box -->

                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title"><i class="fa fa-comments"></i> SMS</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="alert alert-danger" role="alert">
                            <a  style="text-decoration: none" v-for='smsinfo in sms'></br>METHOD: {$ smsinfo.mtd $}</br>ARGUMENTS: {$ smsinfo.args $}</br>RETURN DATA: <span v-if="smsinfo.ret">{$ smsinfo.ret $}</span><span v-else>No return data</span></br></a>
                        </div>
                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>


            <!-- ============================================================= -->

            <section id="devicedata">
                <h2 class="page-header"></h2>
                <!-- /.box -->

                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title"><i class="fa fa-phone"></i> Device Data</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="alert alert-success" role="alert">
                            <a  style="text-decoration: none" v-for='devicedatainfo in devicedata'></br>METHOD: {$ devicedatainfo.mtd $}</br>ARGUMENTS: {$ devicedatainfo.args $}</br>RETURN DATA: <span v-if="devicedatainfo.ret">{$ devicedatainfo.ret $}</span><span v-else>No return data</span></br></a>
                        </div>
                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>


            <!-- ============================================================= -->


            <section id="dexclassloader">
                <h2 class="page-header"></h2>
                <!-- /.box -->

                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title"><i class="fa fa-asterisk"></i> Dex Class Loader</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="alert alert-warning" role="alert">
                            <a  style="text-decoration: none" v-for='dexinfo in dexclassloader'></br>METHOD: {$ dexinfo.mtd $}</br>ARGUMENTS: {$ dexinfo.args $}</br>RETURN DATA: <span v-if="dexinfo.ret">{$ dexinfo.ret $}</span><span v-else>No return data</span></br></a>
                        </div>
                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>


            <!-- ============================================================= -->


            <section id="reflection">
                <h2 class="page-header"></h2>
                <!-- /.box -->

                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title"><i class="fa fa-object-ungroup"></i> Reflection</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="alert alert-info" role="alert">
                            <a  style="text-decoration: none" v-for='refinfo in reflection'></br>METHOD: {$ refinfo.mtd $}</br>ARGUMENTS: {$ refinfo.args $}</br>RETURN DATA: <span v-if="refinfo.ret">{$ refinfo.ret $}</span><span v-else>No return data</span></br></a>
                        </div>
                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>


            <!-- ============================================================= -->



            <section id="systemmanager">
                <h2 class="page-header"></h2>
                <!-- /.box -->

                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title"><i class="fa fa-cogs"></i> System Manager</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="alert alert-danger" role="alert">
                            <a  style="text-decoration: none" v-for='sysinfo in sysmanager'></br>METHOD: {$ sysinfo.mtd $}</br>ARGUMENTS: {$ sysinfo.args $}</br>RETURN DATA: <span v-if="sysinfo.ret">{$ sysinfo.ret $}</span><span v-else>No return data</span></br></a>
                        </div>
                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>


            <!-- ============================================================= -->



            <section id="process">
                <h2 class="page-header"></h2>
                <!-- /.box -->

                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title"><i class="fa fa-bar-chart-o"></i> Process</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">

                        <div class="alert alert-success" role="alert">
                            <a  style="text-decoration: none" v-for='processinfo in process'></br>METHOD: {$ processinfo.mtd $}</br>ARGUMENTS: {$ processinfo.args $}</br>RETURN DATA: <span v-if="processinfo.ret">{$ processinfo.ret $}</span><span v-else>No return data</span></br></a>
                            </div>
                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </section>

        </div><!-- /.content -->
    </div><!-- /.content-wrapper -->





    <footer class="main-footer">
        <strong>© 2017 SafeCode Technology - SafeCode</strong>
    </footer>

    <!-- Control Sidebar -->
    <aside class="control-sidebar control-sidebar-dark">
        <!-- Create the tabs -->
        <div class="pad">
            Console logs will be shown here.
        </div>
    </aside><!-- /.control-sidebar -->
    <!-- Add the sidebar's background. This div must be placed
         immediately after the control sidebar -->
    <div class="control-sidebar-bg"></div>

</div><!-- ./wrapper -->
</body>
{% endblock %}

{% block js %}
<!-- FastClick -->
<script src="/static/plugins/fastclick/fastclick.min.js"></script>
<!-- AdminLTE App -->
<script src="/static/dash/js/app.min.js"></script>
<!-- SlimScroll 1.3.0 -->
<script src="/static/plugins/slimScroll/jquery.slimscroll.min.js"></script>
<!-- <script src="/static/js/run_prettify.js"></script>-->
<script src="/static/js/docs.js"></script>

<script>
    Vue.config.silent = false;
    var $vm = new Vue({
        el: '#app',
        delimiters: ['{$', '$}'],
        data: {
            fileio: [],
            networkcall: [],
            bindercall: [],
            crypto: [],
            deviceinfo: [],
            base64: [],
            content: [],
            sms: [],
            devicedata: [],
            dexclassloader: [],
            reflection: [],
            sysmanager: [],
            process: []
        }
    });

    $.ajax({
        url: "/project/dynamicinfo",
        data: {sim: "{{id}}"},
        method: "GET",
        success: function(data) {
            for(var info of data.data) {
                switch (info.type) {
                    case "API_FILEIO":
                        $vm.fileio.push(info);
                        break;
                    case "API_NET":
                        $vm.networkcall.push(info);
                        break;
                    case "API_BINDER":
                        $vm.bindercall.push(info);
                        break;
                    case "API_CRYPTO":
                        $vm.crypto.push(info);
                        break;
                    case "API_DEVICEINFO":
                        $vm.deviceinfo.push(info);
                        break;
                    case "API_BASE64":
                        $vm.base64.push(info);
                        break;
                    case "API_CNTVAL":
                        $vm.content.push(info);
                        break;
                    case "API_SMS":
                        $vm.sms.push(info);
                        break;
                    case "API_SYSPROP":
                        $vm.devicedata.push(info);
                        break;
                    case "API_DEXLOADER":
                        $vm.dexclassloader.push(info);
                        break;
                    case "API_REFLECT":
                        $vm.reflection.push(info);
                        break;
                    case "API_ACNTMNGER":
                        $vm.sysmanager.push(info);
                        break;
                    case "API_CMD":
                        $vm.process.push(info);
                    default:
                        break;
                }
            }
            console.log($vm.content);
            return;
        }
    })
</script>
{% endblock %}